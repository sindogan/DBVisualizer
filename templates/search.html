<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Searching Algorithms</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .box {
            width: 50px; height: 50px; border: 2px solid #4a90e2; 
            display: inline-flex; align-items: center; justify-content: center;
            margin: 5px; font-weight: bold; font-size: 1.2rem; transition: 0.3s;
            border-radius: 8px; background: white;
        }
        .active { background-color: #f1c40f; transform: scale(1.1); border-color: #f39c12; }
        .found { background-color: #2ecc71; color: white; border-color: #27ae60; }
        .disabled { opacity: 0.3; background-color: #ddd; }
    </style>
</head>
<body class="p-4 bg-light">
<div class="container text-center">
    <a href="../index.html" class="btn btn-outline-secondary mb-4 float-start">&larr; Dashboard</a>
    <h2 class="mb-4">Searching Visualizer</h2>

    <div class="card p-3 mb-4 shadow-sm">
        <div class="row g-3 align-items-center justify-content-center">
            <div class="col-md-6">
                <input type="text" id="manualInput" class="form-control" placeholder="Örn: 10, 25, 3, 45, 12 (Virgülle ayırın)">
            </div>
            <div class="col-auto">
                <button class="btn btn-dark" onclick="loadManualList()">Listeyi Yükle</button>
            </div>
            <div class="col-auto">
                <button class="btn btn-secondary" onclick="resetGrid()">Rastgele Liste</button>
            </div>
        </div>
    </div>

    <div id="array-container" class="mb-5 p-4 bg-white rounded shadow-sm" style="min-height: 120px; display: flex; flex-wrap: wrap; justify-content: center;"></div>

    <div class="row justify-content-center gap-3">
        <div class="col-auto">
            <input type="number" id="target" class="form-control" placeholder="Aranacak Sayı" style="width: 150px;">
        </div>
        <div class="col-auto">
            <button class="btn btn-primary" onclick="linearSearch()">Linear Search</button>
            <button class="btn btn-success" onclick="binarySearch()">Binary Search</button>
        </div>
    </div>
    <div id="log" class="mt-4 text-muted fw-bold h5"></div>
</div>

<script>
    let data = [];
    const container = document.getElementById('array-container');
    const log = document.getElementById('log');

    // Görselleştirmeyi Çizen Fonksiyon
    function render() {
        container.innerHTML = '';
        data.forEach((num, idx) => {
            const box = document.createElement('div');
            box.className = 'box shadow-sm';
            box.id = `box-${idx}`;
            box.innerText = num;
            container.appendChild(box);
        });
    }

    // Kullanıcının Girdiği Listeyi Yükle
    function loadManualList() {
        const input = document.getElementById('manualInput').value;
        if (!input.trim()) {
            alert("Lütfen sayıları virgülle ayırarak girin!");
            return;
        }

        // String'i sayı dizisine çevir ve temizle
        data = input.split(',')
                    .map(item => parseInt(item.trim()))
                    .filter(item => !isNaN(item));

        if (data.length === 0) {
            alert("Geçerli bir sayı bulunamadı!");
            return;
        }

        render();
        log.innerText = `Liste yüklendi: ${data.length} eleman mevcut.`;
    }

    // Rastgele Liste Oluştur
    function resetGrid() {
        data = [];
        for(let i=0; i<12; i++) {
            data.push(Math.floor(Math.random() * 99) + 1);
        }
        render();
        log.innerText = "Rastgele Liste Oluşturuldu.";
    }

    const sleep = (ms) => new Promise(r => setTimeout(r, ms));

    async function linearSearch() {
        const target = parseInt(document.getElementById('target').value);
        if(isNaN(target)) return alert("Lütfen aranacak bir sayı girin!");
        
        // Önceki aramaları temizle
        render();
        log.innerText = "Linear Search Başlatılıyor...";
        
        for(let i=0; i<data.length; i++) {
            const box = document.getElementById(`box-${i}`);
            box.classList.add('active');
            log.innerText = `İndeks ${i} kontrol ediliyor: ${data[i]} == ${target}?`;
            await sleep(600);

            if(data[i] === target) {
                box.classList.remove('active');
                box.classList.add('found');
                log.innerText = `BULDUM! ${target} sayısı ${i}. indekste.`;
                return;
            }
            box.classList.remove('active');
        }
        log.innerText = "Aranan sayı listede bulunamadı.";
    }

    async function binarySearch() {
        const target = parseInt(document.getElementById('target').value);
        if(isNaN(target)) return alert("Lütfen aranacak bir sayı girin!");

        // Binary search için sıralama şart
        log.innerText = "Binary Search için liste sıralanıyor...";
        data.sort((a,b) => a-b);
        render();
        await sleep(1000);

        let left = 0;
        let right = data.length - 1;

        while(left <= right) {
            let mid = Math.floor((left + right) / 2);
            const midBox = document.getElementById(`box-${mid}`);
            
            // Etkisiz bölgeleri karart
            for(let i=0; i<data.length; i++) {
                const box = document.getElementById(`box-${i}`);
                box.classList.remove('active');
                if(i < left || i > right) box.classList.add('disabled');
                else box.classList.remove('disabled');
            }

            midBox.classList.add('active');
            log.innerText = `Orta nokta kontrol ediliyor: İndeks ${mid} (Değer: ${data[mid]})`;
            await sleep(1000);

            if(data[mid] === target) {
                midBox.classList.remove('active');
                midBox.classList.add('found');
                log.innerText = `BULDUM! ${target} sayısı ${mid}. indekste.`;
                return;
            }

            if(data[mid] < target) {
                left = mid + 1;
                log.innerText = `${target} daha büyük, sağ tarafa bakılıyor.`;
            } else {
                right = mid - 1;
                log.innerText = `${target} daha küçük, sol tarafa bakılıyor.`;
            }
            await sleep(500);
        }
        log.innerText = "Aranan sayı listede bulunamadı.";
    }

    // İlk açılışta boş kalmasın
    resetGrid();
</script>
</body>
</html>